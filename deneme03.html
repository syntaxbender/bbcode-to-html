<textarea id="textbox"></textarea>
<input type="button" onclick="go_b_davay_davay_rusj_b();">
<script type="text/javascript">
	function go_b_davay_davay_rusj_b(){
		var text = document.getElementById("textbox").value;
		GGCodeParser(text);
	}
	function GGCodeParseError(text){
		alert(text);
	}
	function bold_func(text,open_tag_start, open_tag_end, close_tag_start, close_tag_end){
		text = replaceRange(text, open_tag_start,  open_tag_end, "<b>"); // "that is a string"
		return replaceRange(text, close_tag_start,  close_tag_end, "</b>"); // "that is a string"
	}
	function GGCodeParser(text){
		var text_array = [];
		var start = 0;
		var total = text.length;

		var tag_checker = [];
		var tag_placements = [];
		var tagarray = {"b":["tag_close_type","bold_func"],"code":["tag_close_type","code_func"],"img":["tag_close_type","img_func"]}; // tag list
		var buffer = "";

		for(start;start<text.length;start++){
			if(text[start] == "]"){

				console.log(buffer);
				if(tagarray[buffer] != null){
					tag_checker.push([buffer,tag_placements.length]);
					tag_placements.push([buffer,text_array.length]);
					text_array.push(buffer);
				}else if(tagarray[buffer.substr(1, buffer.length)] != null && buffer.substr(0, 1) == "/") {
					if(tag_checker[(tag_checker.length-1)][0] == buffer.substr(1, buffer.length)){
						tag_placements[tag_checker[(tag_checker.length-1)][1]].push(text_array.length);
						text_array.push(buffer);
						tag_checker.splice((tag_checker.length-1), 1);
					}else{
						GGCodeParseError(11);
						return;
					}
				}else{
					text_array.push("["+buffer+"]");
				}
				buffer = "";
			}else if(text[start] == "["){
				text_array.push(buffer);
				buffer = "";
			}else{
				buffer += text[start];
			}

		}
		if(tag_checker.length != 0){
			GGCodeParseError(22);
			return;
		}
			console.log(text_array);

		console.log(tag_placements);
	}
</script> 
